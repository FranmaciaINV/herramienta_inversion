<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herramientas</title>
    <style>
        /* Estilos generales */
        body {
            display: flex;
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #000; /* Fondo negro */
            color: #fff; /* Texto blanco */
        }

        /* Barra de navegaci√≥n */
        nav {
            width: 250px;
            background-color: #ff7300; /* Naranja */
            color: white;
            height: 100vh;
            padding: 20px;
        }

        nav h2 {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 1px solid white;
            padding-bottom: 10px;
        }

        nav a {
            color: white;
            text-decoration: none;
            font-size: 21px;
            display: block;
            margin: 15px 0;
            transition: color 0.3s, text-shadow 0.3s;
        }

        nav a.disabled {
            color: #444; /* Oscuro */
            cursor: not-allowed;
        }

        nav a.disabled:hover {
            cursor: not-allowed;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        }

        nav a:hover {
            color: #fff; /* Naranja oscuro */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        }

        /* √Årea principal */
        main {
            flex: 1;
            padding: 20px;
            background-color: #222; /* Fondo gris oscuro */
        }

        h2 {
            color: #ff7300; /* T√≠tulos naranjas */
        }

        label, input, button {
            display: block;
            width: 100%;
            margin-bottom: 15px;
            font-size: 16px;
        }

        input {
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #333; /* Fondo del input gris oscuro */
            color: white;
        }

        button {
            background-color: #ff7300; /* Bot√≥n naranja */
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
        }

        button:hover {
            background-color: #ff5200; /* Bot√≥n naranja oscuro */
        }

        /* Contenedor de m√©tricas */
    .metrics-container {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
        gap: 20px;
    }

    .metric-card {
        background-color: #333;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        flex: 1;
        color: #fff;
    }

    .metric-card h3 {
        color: #ff7300;
        margin-bottom: 10px;
    }

    /* Contenedor de indicadores */
    .indicators-container {
        display: flex;
        justify-content: space-around;
        gap: 30px;
        padding: 20px;
    }

    .indicators-block {
        width: 45%;
        background-color: #222;
        padding: 20px;
        border-radius: 8px;
    }

    .indicator-title {
        text-align: center;
        color: #ff7300;
        margin-bottom: 20px;
    }

    .indicator {
        background-color: #333;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 15px;
    }

    .indicator h4 {
        color: #ff7300;
        margin-bottom: 8px;
    }

    .indicator p {
        color: #fff;
        margin: 5px 0;
    }

    /* Contenedor de gr√°ficos */
    .charts-container {
        display: flex;
        justify-content: center;
        margin-top: 40px;
        gap: 20px;
    }

        /* Resultados */
        .hidden {
            display: none;
        }

        .result-container {
            background-color: #333; /* Fondo gris oscuro */
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .result-container h3 {
            color: #ff7300; /* T√≠tulos de resultados en naranja */
        }

        .error {
            color: #ff4c4c; /* Errores en rojo */
        }

        /* Estilo para las noticias */
        .noticia {
            background-color: #fff; /* Fondo blanco */
            color: #000; /* Texto negro */
            border: 1px solid #ddd; /* Borde gris claro */
            border-radius: 8px; /* Bordes redondeados */
            padding: 15px; /* Espaciado interno */
            margin-bottom: 15px; /* Espaciado entre noticias */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Sombra ligera */
        }

        .noticia h2 {
            font-size: 20px;
            margin-bottom: 10px;
            color: #ff7300; /* Color naranja para los t√≠tulos */
        }

        .noticia p {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .noticia a {
            color: #007bff; /* Azul para enlaces */
            text-decoration: none; /* Sin subrayado */
            font-weight: bold;
        }

        .noticia a:hover {
            text-decoration: underline; /* Subrayado al pasar el cursor */
        }

        /* Estilos espec√≠ficos para el Asistente de Servicios */
        #tabs {
            display: flex;
            justify-content: center;
            background-color: #000;
            padding: 10px;
        }

        #tabs button {
            background-color: #ff7300;
            border: none;
            color: white;
            padding: 10px 20px;
            margin: 0 5px;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px;
        }

        #tabs button:hover {
            background-color: #e66400;
        }

        #tabs button.active {
            background-color: #333;
        }

        .contenedor-companias {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .compania-card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .compania-card h3 {
            margin: 0 0 10px;
            font-size: 20px;
            color: #ff7300;
        }

        .compania-card p {
            margin: 0 0 10px;
            color: #000;
        }

        .error {
            color: red;
        }

        #pagination {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        #pagination button {
            background-color: #ff7300;
            border: none;
            color: white;
            padding: 10px 15px;
            margin: 0 5px;
            cursor: pointer;
            font-size: 14px;
            border-radius: 5px;
        }

        #pagination button.active {
            background-color: #333;
        }

        #pagination button:hover {
            background-color: #e66400;
        }

        /* Animaci√≥n de parpadeo */
        @keyframes blink {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0;
            }
        }

        /* Mensajes de chat */
.message {
    padding: 10px; /* Espaciado interno */
    border-radius: 8px;
    margin-bottom: 10px;
    max-width: 90%; /* Limitar ancho m√°ximo */
    margin-left: auto; /* Centrar horizontalmente */
    margin-right: auto; /* Centrar horizontalmente */
    line-height: 1.5;
}

.message.assistant {
    background-color: #444;
    color: #fff;
    text-align: left;
}

.message.user {
    background-color: #ff7300;
    color: #fff;
    text-align: right;
    margin-left: auto; /* Asegurarse de que tambi√©n se aplique aqu√≠ */
    margin-right: auto; /* Asegurarse de que tambi√©n se aplique aqu√≠ */
}

/* Contenedor del chat */
#chat-container {
    background-color: #222;
    padding: 20px;
    border-radius: 8px;
    max-width: 600px;
    margin: 20px auto;
}

#chat-messages {
    background-color: #333;
    padding: 10px;
    border-radius: 8px;
    max-height: 400px;
    overflow-y: auto;
}

/* üåé Dise√±o Responsive */
@media (max-width: 1024px) {
    /* Ajuste del men√∫ lateral en tablets y m√≥viles */
    nav {
        width: 200px;
        padding: 15px;
    }
    nav a {
        font-size: 18px;
        margin: 10px 0;
    }
    main {
        padding: 15px;
    }
}

/* üì± Estilos para m√≥viles */
@media (max-width: 768px) {
    body {
        flex-direction: column;
    }

    /* üìå Men√∫ lateral oculto y bot√≥n para mostrarlo */
    nav {
        width: 100%;
        height: auto;
        position: fixed;
        top: 0;
        left: 0;
        background-color: #ff7300;
        padding: 10px;
        text-align: center;
        z-index: 1000;
        display: none;
    }

    nav.active {
        display: block;
    }

    nav h2 {
        font-size: 18px;
    }

    nav a {
        font-size: 16px;
        padding: 10px 0;
    }

    /* üìå Bot√≥n para abrir/cerrar men√∫ */
    .menu-toggle {
        display: block;
        background-color: #ff7300;
        color: white;
        font-size: 18px;
        padding: 10px;
        text-align: center;
        cursor: pointer;
    }

    main {
        margin-top: 50px;
        padding: 10px;
    }

    /* üìå Ajuste de secciones */
    #buscador-container,
    #simulador-container,
    #hipoteca-container {
        max-width: 100%;
        padding: 20px;
    }

    #chat-messages {
        font-size: 16px;
        padding: 15px;
    }
}

/* üåü ESTILOS DEL POPUP */
.popup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8); /* Fondo oscuro */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.popup-content {
    background: #222;
    padding: 20px;
    border-radius: 10px;
    text-align: center;
    color: white;
    max-width: 400px;
    width: 90%;
    box-shadow: 0px 0px 10px rgba(255, 115, 0, 0.7);
}

.popup-content h2 {
    color: #ff7300;
    margin-bottom: 10px;
}

.popup-content input {
    width: 90%;  
    padding: 12px; 
    margin: 10px auto; 
    display: block; 
    border: 1px solid #ff7300; 
    border-radius: 5px; 
    background-color: #333; 
    color: white; 
    text-align: center; 
    font-size: 16px; 
}


.popup-content button {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    background-color: #ff7300;
    border: none;
    color: white;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
}

.popup-content button:hover {
    background-color: #ff5200;
}

    </style>
</head>
<body>
    <nav>
       <!-- POPUP DE EMAIL -->
<div id="emailPopup" class="popup">
    <div class="popup-content">
        <h2>HERRAMIENTA INVERSI√ìN INMOBILIARIA</h2>
        <p>Introduce tu email para acceder:</p>
        <input type="email" id="emailInput" placeholder="Tu email aqu√≠..." required>
        <button onclick="guardarEmail()">Acceder</button>
    </div>
</div>
 
</div>

        <h2>
            <a href="#" onclick="showSection('default-summary')" style="color: #fff; text-decoration: none;">
                Herramientas
            </a>
        </h2>
        <a href="#" onclick="showSection('demografia')">Estudio Demogr√°fico</a>
        <a href="#" onclick="showSection('reformas')">Agente de Reformas</a>
        <a href="#" onclick="showSection('calculadora-rentabilidad')">Calculadora de Rentabilidad Inmobiliaria</a>
        <a href="#" onclick="showSection('broker-hipotecario')">Bancos y Tasadoras Homologadas</a>
        <a href="#" onclick="showAsistenteHipotecas()">Broker Hipotecario</a>
        <a href="#" onclick="showSection('servicios')">Compa√±√≠as de Servicios</a>
        <a href="#" onclick="showBuscadorCompanias()">Buscador de Compa√±√≠as</a>
        <a href="#" onclick="showSection('generador-contratos')">Generador de Contratos</a>
        <a href="#" onclick="showSection('noticias')">Newsletter Inmobiliaria</a>
        <a href="#" onclick="showSimuladorNegociaciones()">Simulador de Negociaciones</a>
         <!-- Mantenemos los dem√°s agentes sin cambios -->
        <a href="#" onclick="showBetaSection('Decorador de Interiores', 'Este asistente analiza planos o fotos de tu vivienda y te asesora con ideas de decoraci√≥n adaptadas a tus gustos y presupuesto. Adem√°s, genera im√°genes 3D para visualizar c√≥mo quedar√° tu hogar con las recomendaciones aplicadas.')">
            Decorador de Interiores
        </a>
        
               
    </nav>
    
    <main id="main-content">
        <!-- Resumen general con indicadores inmobiliarios y econ√≥micos -->
        <section id="dashboard-summary">
            <h2 style="text-align: center; color: #ff7300;">Principales Indicadores Inmobiliarios y Econ√≥micos</h2>
            <h2 style="text-align: center; color: #ff7300;">Enero 2025</h2>

            <div class="indicators-container">
        <!-- Bloque de Indicadores Inmobiliarios -->
        <div class="indicators-block">
            <h3 class="indicator-title">Indicadores Inmobiliarios</h3>

            <div class="indicator">
                <h4>Precio Medio m¬≤ Nacional</h4>
                <p><strong>Precio Medio m¬≤:</strong> 2.237‚Ç¨ m¬≤</p>
                <p><strong>Variaci√≥n interanual:</strong> 6,6%</p>
                <p><strong>Variaci√≥n desde m√°ximos:</strong> -12,9%</p>
            </div>

            <div class="indicator">
                <h4>Compraventa de Viviendas Nacional</h4>
                <p><strong>Variaci√≥n interanual:</strong> 15,8%</p>
                <p><strong>N√∫mero absoluto:</strong> 54.299</p>
                <p><strong>Variaci√≥n acumulada:</strong> 7,5%</p>
            </div>

            <div class="indicator">
                <h4>√çndice de Referencia de Arrendamiento de Vivienda - Diciembre 2024</h4>
                <p><strong>Variaci√≥n anual:</strong> 2,28%</p>
            </div>

            <div class="indicator">
                <h4>Visados de Obra Nueva Nacional</h4>
                <p><strong>Variaci√≥n interanual:</strong> 28,7%</p>
                <p><strong>N√∫mero absoluto:</strong> 11.457</p>
                <p><strong>Variaci√≥n acumulada:</strong> 11,5%</p>
            </div>

            <div class="indicator">
                <h4>Oferta en Portales Inmobiliarios</h4>
                <p><strong>N√∫mero absoluto:</strong> 572.379</p>
                <p><strong>Variaci√≥n interanual:</strong> -18,68%</p>
            </div>

            <div class="indicator">
                <h4>Hipotecas Nacional</h4>
                <p><strong>Variaci√≥n interanual:</strong> 17,9%</p>
                <p><strong>N√∫mero absoluto:</strong> 38.497</p>
                <p><strong>Variaci√≥n acumulada:</strong> 9,8%</p>
            </div>

        </div>

        <!-- Bloque de Indicadores Econ√≥micos -->
        <div class="indicators-block">
            <h3 class="indicator-title">Indicadores Econ√≥micos</h3>

            <div class="indicator">
                <h4>IPC (√çndice de Precios al Consumo)</h4>
                <p><strong>Tasa anual:</strong> 3,0%</p>
            </div>

            <div class="indicator">
                <h4>Eur√≠bor</h4>
                <p><strong>Tasa mensual:</strong> 2,52%</p>
            </div>

            <div class="indicator">
                <h4>Afiliados a la Seguridad Social</h4>
                <p><strong>Variaci√≥n interanual:</strong> 2,4%</p>
                <p><strong>N√∫mero absoluto:</strong> 21.095.814</p>
            </div>

            <div class="indicator">
                <h4>Paro Registrado Nacional</h4>
                <p><strong>Variaci√≥n interanual:</strong> -6,1%</p>
                <p><strong>N√∫mero absoluto:</strong> 2.599.443</p>
            </div>
        </div>
    </div>
</section>

        <section id="demografia" class="hidden">
        <!-- Agente Demogr√°fico -->
        <h2>Agente Demogr√°fico</h2>
    <label for="codigo-postal">Selecciona un municipio para consultar:</label>
    <select id="codigo-postal">
        <option value="" disabled selected>Municipios disponibles:</option>
        <option value="28080">28080 ‚ÄúMajadahonda‚Äù</option>
        <option value="03065">03065 ‚ÄúElche‚Äù</option>
        <option value="37085">37085 ‚ÄúCarbajosa de la Sagrada‚Äù</option>
        <option value="08019">08019 ‚ÄúBarcelona‚Äù</option>
        <option value="49275">49275 ‚ÄúZamora‚Äù</option>
        <option value="30024">30024 ‚ÄúLorca‚Äù</option>
        <option value="28079">28079 ‚ÄúMadrid‚Äù</option>
        <option value="48020">48020 ‚ÄúBilbao‚Äù</option>
        <option value="13013">13013 ‚ÄúAlmagro‚Äù</option>
        <option value="18087">18087 ‚ÄúGranada‚Äù</option>
        <option value="36038">36038 ‚ÄúPontevedra‚Äù</option>
    </select>
    <button onclick="consultarDemografia()">Consultar</button>
    <div id="resultados-demografia" class="result-container hidden"></div>
</section>
        
        <!-- Agente de Reformas -->
        <section id="reformas" class="hidden">
            <h2>Agente de Reformas</h2>
            <p>Selecciona las reformas y proporciona la informaci√≥n requerida:</p>
            <div>
                <label>
                    <input type="checkbox" id="ventanas" onchange="toggleInput('ventanas', 'cantidad-ventanas')">
                    Instalar Ventanas
                </label>
                <input type="number" id="cantidad-ventanas" class="hidden" placeholder="Cantidad de ventanas">
            </div>
            <div>
                <label>
                    <input type="checkbox" id="radiadores" onchange="toggleInput('radiadores', 'cantidad-radiadores')">
                    Instalar Radiadores
                </label>
                <input type="number" id="cantidad-radiadores" class="hidden" placeholder="Cantidad de radiadores">
            </div>
            <div>
                <label>
                    <input type="checkbox" id="paredes" onchange="toggleInput('paredes', 'metros-paredes')">
                    Pintar Paredes
                </label>
                <input type="number" id="metros-paredes" class="hidden" placeholder="Metros cuadrados">
            </div>
            <div>
                <label>
                    <input type="checkbox" id="puertas" onchange="toggleInput('puertas', 'cantidad-puertas')">
                    Instalar Puertas de Entrada
                </label>
                <input type="number" id="cantidad-puertas" class="hidden" placeholder="Cantidad de puertas">
            </div>
            <button onclick="consultarReformas()">Consultar</button>
            <div id="resultados-reformas" class="result-container hidden"></div>
            <p class="additional-info">
                *Los precios son obtenidos de la media nacional y pueden variar dependiendo de la zona y la mano de obra.
            </p>
        </section>
    
        <!-- Calculadora de Rentabilidad Inmobiliaria -->
        <section id="calculadora-rentabilidad" class="hidden">
            <h2>Calculadora de Rentabilidad Inmobiliaria</h2>
            <label for="valor-inmueble">Valor actual del inmueble (‚Ç¨):</label>
            <input type="number" id="valor-inmueble" placeholder="Ejemplo: 150000">

            <label for="renta-mensual">Renta mensual del inmueble (‚Ç¨):</label>
            <input type="number" id="renta-mensual" placeholder="Ejemplo: 800">

            <label for="gastos-mensuales">Gastos mensuales del inmueble (‚Ç¨):</label>
            <input type="number" id="gastos-mensuales" placeholder="Ejemplo: 200">

            <button onclick="calcularRentabilidad()">Calcular</button>
            <div id="resultados-rentabilidad" class="result-container hidden"></div>
            <style>
                table {
                    width: 100%;
                    border-collapse: collapse; /* Asegura que los bordes no se dupliquen */
                    margin-top: 20px;
                }
            
                th, td {
                    border: 1px solid #fff; /* Borde blanco para que sea visible en el fondo oscuro */
                    padding: 10px;
                    text-align: center;
                }
            
                th {
                    background-color: #ff7300; /* Fondo naranja para los encabezados */
                    color: #fff;
                }
            
                td {
                    background-color: #333; /* Fondo gris oscuro para las celdas */
                    color: #fff;
                }

            </style>
        </section>  
        
        <!-- Secci√≥n de Noticias -->
        <section id="noticias" class="hidden">
            <h2>Noticias del Sector Inmobiliario en Espa√±a</h2>
            <div id="noticias-container">
                <p>Cargando noticias...</p>
            </div>
        </section>

       <!-- Broker Hipotecario -->
<section id="broker-hipotecario" class="hidden">
    <h2>Bancos y Tasadoras Homologadas</h2>
    <p>Selecciona la informaci√≥n que deseas consultar:</p>
    <button onclick="consultarBroker('bancos')">Bancos</button>
    <button onclick="consultarBroker('tasadoras')">Tasadoras Homologadas</button>
    <div id="resultados-broker">
        <h3>Resultados:</h3>
        <table id="tabla-resultados-broker">
            <thead>
                <tr id="cabecera-tabla-broker">
                    <!-- Aqu√≠ se generar√°n din√°micamente las cabeceras -->
                </tr>
            </thead>
            <tbody id="cuerpo-tabla-broker">
                <!-- Aqu√≠ se generar√°n din√°micamente los datos -->
            </tbody>
        </table>
        <!-- Contenedor para la paginaci√≥n -->
        <div id="broker-pagination" style="margin-top: 20px; text-align: center;">
            <!-- Los botones de paginaci√≥n se generar√°n aqu√≠ din√°micamente -->
        </div>
    </div>
</section>

<!-- Asistente Hipotecario -->
<section id="asistente-hipotecas" class="hidden">
    <h2 style="color: #ff7300; text-align: center;">Broker Hipotecario</h2>
    <div id="hipoteca-container" style="
        background-color: #222; 
        padding: 30px; 
        border-radius: 8px; 
        max-width: 800px; 
        margin: 20px auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;">
        
        <div id="hipoteca-messages" style="
            width: 100%; 
            background-color: #333; 
            padding: 20px; 
            border-radius: 8px; 
            color: #fff; 
            font-size: 18px;
            text-align: left;
            line-height: 1.6;">
            
            <div class="message assistant" style="
                background-color: #444; 
                padding: 20px; 
                border-radius: 8px; 
                margin-bottom: 10px;">
                
                <strong>Broker Hipotecario:</strong><br><br>

                ¬°Hola! Soy tu asistente para encontrar la mejor hipoteca.<br><br>

                Mi trabajo es ayudarte a identificar los bancos m√°s adecuados para ti, bas√°ndome en tu perfil financiero y en las mejores condiciones del mercado.<br><br>

                Aqu√≠ puedes optimizar tu b√∫squeda sin complicaciones:
                <ul>
                    <li>Descubre qu√© bancos ofrecen las mejores tasas seg√∫n tu situaci√≥n.</li>
                    <li>Obt√©n una lista priorizada para saber a qui√©n acudir primero.</li>
                    <li>Ahorra tiempo y dinero accediendo a opciones que realmente se ajustan a ti.</li>
                </ul>
                Cuanto mejor sea tu estrategia, mejores ser√°n tus condiciones hipotecarias.<br><br>

                ¬øCu√°l es tu objetivo? ¬øComprar tu primera vivienda, invertir o mejorar tu hipoteca actual?
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
            <p id="coming-soon" style="
                color: #ff7300; 
                font-size: 20px; 
                font-weight: bold; 
                animation: blink 1.5s infinite;">
                Pr√≥ximamente Disponible
            </p>
        </div>
    </div>
</section>


        <!-- Agente de Servicios -->
<section id="servicios" class="hidden">
    <h2>Compa√±√≠as de Servicios</h2>
    <div id="tabs">
        <button id="tab-luz" onclick="mostrarPestana('luz')">Compa√±√≠as de Luz</button>
        <button id="tab-gas" onclick="mostrarPestana('gas')">Compa√±√≠as de Gas</button>
        <button id="tab-luzygas" onclick="mostrarPestana('luzygas')">Compa√±√≠as de Luz y Gas</button>
    </div>

    <div id="contenidos">
        <div id="luz-container" class="contenedor-companias"></div>
        <div id="gas-container" class="contenedor-companias" style="display:none;"></div>
        <div id="luzygas-container" class="contenedor-companias" style="display:none;"></div>
    </div>

    <div id="pagination"></div>
</section>

        <!-- Generador de Contratos -->
<section id="generador-contratos" class="hidden">
    <h2>Generador de Contratos</h2>
    <form method="POST" action="herramienta-inversion.onrender.com/generar-contrato">
        
        <!-- Selector de tipo de contrato -->
        <div style="margin-bottom: 20px;">
            <label for="tipo_contrato" style="color: #fff; font-weight: bold; display: block; margin-bottom: 10px;">
                Selecciona el tipo de contrato:
            </label>
            <select id="tipo_contrato" name="tipo_contrato" required
                style="width: 100%; padding: 10px; background-color: #333; color: #fff; border-radius: 4px; border: none;">
                <option value="arras">Contrato de Arras</option>
                <option value="alquiler" disabled>Contrato de alquiler para vivienda habitual (LAU) - Pr√≥ximamente</option>
                <option value="habitaciones_temporada" disabled>Contrato de alquiler de habitaciones por temporada - Pr√≥ximamente</option>
                <option value="habitaciones_lau" disabled>Contrato de alquiler de habitaciones para vivienda habitual (LAU) - Pr√≥ximamente</option>
                <option value="reserva" disabled>Contrato de reserva de un inmueble - Pr√≥ximamente</option>
            </select>
        </div>

        <!-- Datos del Vendedor -->
        <div style="margin-bottom: 20px;">
            <label for="nombre_vendedor" style="color: #fff; font-weight: bold; display: block; margin-bottom: 10px;">
                Nombre del Vendedor:
            </label>
            <input type="text" id="nombre_vendedor" name="nombre_vendedor" placeholder="Introduce el nombre del vendedor" required
                style="width: 100%; padding: 10px; background-color: #333; color: #fff; border-radius: 4px; border: none;">
        </div>

        <!-- Datos del Comprador -->
        <div style="margin-bottom: 20px;">
            <label for="nombre_comprador" style="color: #fff; font-weight: bold; display: block; margin-bottom: 10px;">
                Nombre del Comprador:
            </label>
            <input type="text" id="nombre_comprador" name="nombre_comprador" placeholder="Introduce el nombre del comprador" required
                style="width: 100%; padding: 10px; background-color: #333; color: #fff; border-radius: 4px; border: none;">
        </div>

        <!-- Bot√≥n para generar y descargar el contrato -->
        <button type="submit" style="width: 100%; padding: 10px 20px; background-color: #ff7300; border: none; border-radius: 4px; color: white; font-size: 16px; cursor: pointer;">
            Generar y Descargar Contrato
        </button>
    </form>
</section>


    </main>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
        // Cargar m√©tricas iniciales
        cargarResumenGeneral();

        // Escuchar clics en los enlaces de navegaci√≥n
        const links = document.querySelectorAll("nav a");
        links.forEach(link => {
            link.addEventListener("click", event => {
                event.preventDefault();
                const sectionId = event.target.getAttribute("onclick").match(/'(.*?)'/)[1];
                showSection(sectionId);
            });
        });
    });

    function showSection(sectionId) {
    // Ocultar todas las secciones excepto el dashboard-summary
    const sections = document.querySelectorAll("main > section");
    sections.forEach(section => {
        if (section.id !== "dashboard-summary") { 
            section.classList.add("hidden");
        }
    });

    // Mostrar la secci√≥n seleccionada
    if (sectionId) {
        const selectedSection = document.getElementById(sectionId);
        if (selectedSection) {
            selectedSection.classList.remove("hidden");

            // Cargar noticias si la secci√≥n seleccionada es "noticias"
            if (sectionId === "noticias") {
                console.log("Cargando noticias...");
                cargarNoticias();
            }
        } else {
            console.error(`No se encontr√≥ la secci√≥n con el ID: ${sectionId}`);
        }
    }
}


    
function showBetaSection(agent, description) {
    // Ocultar todas las secciones
    const sections = document.querySelectorAll("main > section");
    sections.forEach(section => section.classList.add("hidden"));

    // Crear o seleccionar la secci√≥n din√°mica
    let betaSection = document.getElementById("beta-section");
    if (!betaSection) {
        betaSection = document.createElement("section");
        betaSection.id = "beta-section";
        document.getElementById("main-content").appendChild(betaSection);
    }

    // Actualizar el contenido del agente seleccionado
    betaSection.innerHTML = `
        <h2>${agent}</h2>
        <p>${description}</p>
        <div class="metric-card">
            <h3>${agent}</h3>
            <p>Pr√≥ximamente Disponible.</p>
        </div>
    `;

    // Mostrar la secci√≥n
    betaSection.classList.remove("hidden");
}

    
        function toggleInput(checkboxId, inputId) {
            const checkbox = document.getElementById(checkboxId);
            const input = document.getElementById(inputId);
            input.classList.toggle('hidden', !checkbox.checked);
            if (!checkbox.checked) input.value = '';
        }
    
        function consultarDemografia() {
    const codigoPostal = document.getElementById('codigo-postal').value.trim();
    const resultadosDiv = document.getElementById('resultados-demografia');

    if (!codigoPostal) {
        resultadosDiv.innerHTML = '<p class="error">Por favor, introduce un c√≥digo postal.</p>';
        resultadosDiv.classList.remove('hidden');
        return;
    }

    resultadosDiv.innerHTML = '<p>Cargando resultados...</p>';
    resultadosDiv.classList.remove('hidden');

    fetch('https://herramienta-inversion.onrender.com/consulta-demografica', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ codigo_postal: codigoPostal })
})

    .then(response => response.json())
    .then(data => {
        console.log("Datos recibidos del backend:", data); // Depuraci√≥n
        if (data.error) {
            resultadosDiv.innerHTML = `<p class="error">${data.error}</p>`;
        } else {
            resultadosDiv.innerHTML = `
                <pre>${data.respuesta_clara}</pre>
                <h3>Gr√°ficos Demogr√°ficos:</h3>
                <canvas id="grafico-demografico" style="width: 100%; max-width: 600px; height: 300px;"></canvas>
            `;
            
            // Verificar si el objeto 'graficos' existe antes de generar el gr√°fico
            if (data.graficos && data.graficos.labels && data.graficos.values) {
                generarGraficoDemografico('grafico-demografico', data.graficos.labels, data.graficos.values);
            } else {
                console.warn("No se encontraron datos para generar el gr√°fico.");
                resultadosDiv.innerHTML += `<p class="error">No hay datos disponibles para los gr√°ficos demogr√°ficos.</p>`;
            }
        }
    })
    .catch(err => {
        resultadosDiv.innerHTML = `<p class="error">Error: ${err.message}</p>`;
    });
}

function generarGraficoDemografico(canvasId, labels, values) {
    const canvas = document.getElementById(canvasId);

    // Asegurarse de que el canvas existe antes de intentar generar el gr√°fico
    if (!canvas) {
        console.error(`No se encontr√≥ un elemento <canvas> con el ID: ${canvasId}`);
        return;
    }

    const ctx = canvas.getContext('2d');
    
    // Crear el gr√°fico
    new Chart(ctx, {
        type: 'bar', // Cambiar a "bar" si prefieres barras en lugar de l√≠neas
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Poblaci√≥n Espa√±ola',
                    data: [values[0], values[2]], // Valores de los espa√±oles (2024, 2023)
                    backgroundColor: '#4CAF50', // Verde
                    borderColor: '#388E3C', // Verde m√°s oscuro
                    borderWidth: 1
                },
                {
                    label: 'Poblaci√≥n Extranjera',
                    data: [values[1], values[3]], // Valores de los extranjeros (2024, 2023)
                    backgroundColor: '#FF7043', // Naranja
                    borderColor: '#E64A19', // Naranja m√°s oscuro
                    borderWidth: 1
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top', // Posici√≥n de la leyenda
                    labels: {
                        color: '#fff' 
                    }
                },
                tooltip: {
                    enabled: true,
                    backgroundColor: '#fff', // Fondo blanco en el tooltip
                    bodyColor: '#000', // Texto negro en el tooltip
                    borderColor: '#ddd', // Borde claro del tooltip
                    borderWidth: 1
                }
            },
            scales: {
                x: {
                    grid: {
                        display: false // Ocultar las l√≠neas de la cuadr√≠cula en X
                    },
                    ticks: {
                        color: '#fff' // Color negro para los n√∫meros del eje X
                    }
                },
                y: {
                    grid: {
                        color: '#ddd' // L√≠neas de cuadr√≠cula en gris claro
                    },
                    ticks: {
                        color: '#fff' // Color negro para los n√∫meros del eje Y
                    },
                    beginAtZero: true // Comenzar desde cero
                }
            }
        }
    });
}


        function consultarReformas() {
            const reformas = [];
            const resultadosDiv = document.getElementById('resultados-reformas');
    
            if (document.getElementById('ventanas').checked) {
                reformas.push({ tipo: 'ventana', cantidad: parseInt(document.getElementById('cantidad-ventanas').value || 0) });
            }
            if (document.getElementById('radiadores').checked) {
                reformas.push({ tipo: 'radiadores', cantidad: parseInt(document.getElementById('cantidad-radiadores').value || 0) });
            }
            if (document.getElementById('paredes').checked) {
                reformas.push({ tipo: 'paredes', metros: parseFloat(document.getElementById('metros-paredes').value || 0) });
            }
            if (document.getElementById('puertas').checked) {
                reformas.push({ tipo: 'puerta', cantidad: parseInt(document.getElementById('cantidad-puertas').value || 0) });
            }
    
            if (reformas.length === 0) {
                resultadosDiv.innerHTML = '<p class="error">Seleccione al menos una reforma.</p>';
                resultadosDiv.classList.remove('hidden'); // Aseg√∫rate de que el div sea visible
                return;
            }
    
            resultadosDiv.innerHTML = '<p>Cargando resultados...</p>';
            resultadosDiv.classList.remove('hidden'); // Aseg√∫rate de que el div sea visible
    
            fetch('https://herramienta-inversion.onrender.com/consulta-reforma', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ reformas })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    resultadosDiv.innerHTML = `<p class="error">${data.error}</p>`;
                } else {
                    resultadosDiv.innerHTML = data.respuesta_html;
                }
            })
            .catch(error => {
                resultadosDiv.innerHTML = `<p class="error">Error al realizar la consulta: ${error.message}</p>`;
            });
        }
    
        function calcularRentabilidad() {
            const resultadosDiv = document.getElementById('resultados-rentabilidad');
            const datos = {
                valorInmueble: parseFloat(document.getElementById('valor-inmueble').value || 0),
                rentaMensual: parseFloat(document.getElementById('renta-mensual').value || 0),
                gastosMensuales: parseFloat(document.getElementById('gastos-mensuales').value || 0),
            };

            if (!datos.valorInmueble || !datos.rentaMensual || !datos.gastosMensuales) {
                resultadosDiv.innerHTML = '<p class="error">Por favor, complete todos los campos.</p>';
                resultadosDiv.classList.remove('hidden');
                return;
            }

            resultadosDiv.innerHTML = '<p>Cargando resultados...</p>';
            resultadosDiv.classList.remove('hidden');

            fetch('https://herramienta-inversion.onrender.com/calcular-rentabilidad', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(datos),
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.error) {
                        resultadosDiv.innerHTML = `<p class="error">${data.error}</p>`;
                    } else {
                        mostrarResultados(data, resultadosDiv);
                    }
                })
                .catch((error) => {
                    resultadosDiv.innerHTML = `<p class="error">Error al realizar la consulta: ${error.message}</p>`;
                });
        }

        function mostrarResultados(data, resultadosDiv) {
        // Calcular diferencia entre ingresos y gastos con dos decimales
        const diferenciaIngresosGastos = data.rentabilidad.map(
            (valor, index) => (valor - data.gastos[index]).toFixed(2)
        );

        // Formatear todos los valores a dos decimales
        const valorInmueble = data.valorInmueble.map(v => v.toFixed(2));
        const gastos = data.gastos.map(v => v.toFixed(2));
        const rentabilidad = data.rentabilidad.map(v => v.toFixed(2));

        // Generar tabla de resultados
        resultadosDiv.innerHTML = `
            <h3>Resultados</h3>
            <table>
                <thead>
                    <tr>
                        <th>A√±o</th>
                        <th>Valor del Inmueble (‚Ç¨)</th>
                        <th>Gastos (‚Ç¨)</th>
                        <th>Diferencia Ingresos y Gastos(‚Ç¨)</th>
                        <th>Rentabilidad (‚Ç¨)</th>
                    </tr>
                </thead>
                <tbody>
                    ${data.anios.map((anio, index) => `
                        <tr>
                            <td>${anio}</td>
                            <td>${valorInmueble[index]}</td>
                            <td>${gastos[index]}</td>
                            <td>${diferenciaIngresosGastos[index]}</td>
                            <td>${rentabilidad[index]}</td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
            <canvas id="grafico-datos" style="width: 100%; max-width: 500px; height: 250px !important; max-height: 300px !important; margin-top: 20px;"></canvas>
        `;

        // Generar gr√°fica con todos los datos
        generarGrafico('grafico-datos', data.anios, {
            'Valor del Inmueble (‚Ç¨)': valorInmueble,
        });
    }

    function generarGrafico(canvasId, labels, datasets) {
    const canvas = document.getElementById(canvasId);
    const ctx = canvas.getContext('2d');

    // üîπ Ajustar el tama√±o del canvas
    canvas.style.width = "100%";
    canvas.style.maxWidth = "500px";
    canvas.style.height = "250px";
    canvas.style.maxHeight = "300px"; // üîπ Altura m√°xima fija

    const colors = ['orange', 'red', 'blue', 'green'];

    const chartData = Object.keys(datasets).map((key, index) => ({
        label: key,
        data: datasets[key],
        borderColor: colors[index],
        borderWidth: 2,
        fill: false,
        pointRadius: 4,
    }));

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: chartData,
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, 
            aspectRatio: 1.5, // üîπ Control de proporci√≥n para evitar gr√°ficos demasiado alargados
            plugins: {
                legend: {
                    position: 'top',
                },
            },
            scales: {
                y: {
                    beginAtZero: false, // No fuerza el inicio en 0
                    min: Math.min(...datasets["Valor del Inmueble (‚Ç¨)"]) * 0.95, // üîπ 5% debajo del m√≠nimo
                    max: Math.max(...datasets["Valor del Inmueble (‚Ç¨)"]) * 1.05, // üîπ 5% encima del m√°ximo
                    ticks: {
                        stepSize: 5000, // üîπ Ajuste de saltos en el eje Y
                        color: "#fff",
                        font: { size: 14 },
                    }
                }
            }
        }
    });
}

async function descargarContrato() {
    try {
        const formData = new FormData();
        formData.append("nombre_vendedor", "Juan P√©rez");
        formData.append("nombre_comprador", "Mar√≠a G√≥mez");
        formData.append("tipo_contrato", "arras");

        const response = await fetch("https://herramienta-inversion.onrender.com/generar-contrato", {
            method: "POST",
            body: formData
        });

        if (!response.ok) {
            throw new Error("No se pudo generar el contrato");
        }

        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "Contrato.pdf";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    } catch (error) {
        console.error("Error al descargar el contrato:", error);
    }
}


    async function cargarNoticias() {
    console.log("Funci√≥n cargarNoticias llamada"); // Debug
    const container = document.getElementById("noticias-container");
    if (!container) {
        console.error("No se encontr√≥ el contenedor de noticias.");
        return;
    }

    container.innerHTML = "<p>Cargando noticias...</p>";

    try {
        const response = await fetch("https://herramienta-inversion.onrender.com/obtener-noticias");
        console.log("Respuesta del servidor:", response);

        if (!response.ok) {
            throw new Error(`Error en la solicitud: ${response.status}`);
        }

        const noticias = await response.json();
        console.log("Noticias recibidas:", noticias);

        if (noticias && noticias.length > 0) {
            container.innerHTML = noticias.map(noticia => `
                <div class="noticia">
                    <h2>${noticia.title || "Sin t√≠tulo"}</h2>
                    <p>${noticia.description || "Sin descripci√≥n"}</p>
                    <p><a href="${noticia.url || "#"}" target="_blank" rel="noopener noreferrer">Leer m√°s</a></p>
                </div>
            `).join('');
        } else {
            container.innerHTML = "<p>No hay noticias disponibles en este momento.</p>";
        }
    } catch (error) {
        console.error("Error al cargar las noticias:", error);
        container.innerHTML = `<p class="error">Error al cargar las noticias: ${error.message}</p>`;
    }
}


// Variables para manejar la paginaci√≥n
const itemsPorPagina = 10; // M√°ximo de elementos por p√°gina
let datosBroker = []; // Almacenar√° los datos obtenidos del servidor
let paginaActualBroker = 1; // P√°gina actual

async function consultarBroker(tipo) {
    const url = `https://herramienta-inversion.onrender.com/obtener-datos?tipo=${tipo}`;
    const tablaResultados = document.getElementById("tabla-resultados-broker");
    const cabeceraTabla = document.getElementById("cabecera-tabla-broker");
    const cuerpoTabla = document.getElementById("cuerpo-tabla-broker");

    try {
        const response = await fetch(url);
        const datos = await response.json();

        console.log("üîç Respuesta de la API:", datos);  // üîπ Depuraci√≥n: Ver los datos en la consola

        // Si los datos est√°n vac√≠os, muestra un mensaje
        if (!datos || datos.length === 0) {
            throw new Error("No hay datos disponibles.");
        }

        // Almacenar los datos obtenidos
        datosBroker = datos;
        paginaActualBroker = 1; // Reiniciar a la primera p√°gina
        mostrarPaginaBroker(); // Mostrar la primera p√°gina
    } catch (error) {
        console.error("‚ö†Ô∏è Error al obtener los datos:", error.message);
        cabeceraTabla.innerHTML = "<th>Error al cargar los datos</th>";
        cuerpoTabla.innerHTML = "";
    }
}


function mostrarPaginaBroker() {
    const tablaResultados = document.getElementById("tabla-resultados-broker");
    const cabeceraTabla = document.getElementById("cabecera-tabla-broker");
    const cuerpoTabla = document.getElementById("cuerpo-tabla-broker");
    const inicio = (paginaActualBroker - 1) * itemsPorPagina;
    const fin = inicio + itemsPorPagina;
    const datosPagina = datosBroker.slice(inicio, fin);

    // Limpiar la tabla
    cabeceraTabla.innerHTML = "";
    cuerpoTabla.innerHTML = "";

    if (datosPagina.length > 0) {
        // Crear las cabeceras din√°micas
        const columnas = Object.keys(datosPagina[0]);
        columnas.forEach(columna => {
            const th = document.createElement("th");
            th.textContent = columna;
            cabeceraTabla.appendChild(th);
        });

        // Crear las filas din√°micas
        datosPagina.forEach(fila => {
            const tr = document.createElement("tr");
            columnas.forEach(columna => {
                const td = document.createElement("td");
                td.textContent = fila[columna] || "N/A";
                tr.appendChild(td);
            });
            cuerpoTabla.appendChild(tr);
        });
    } else {
        cabeceraTabla.innerHTML = "<th>No hay datos disponibles</th>";
        cuerpoTabla.innerHTML = "";
    }

    actualizarPaginacionBroker();
}

function actualizarPaginacionBroker() {
    const totalPaginas = Math.ceil(datosBroker.length / itemsPorPagina);
    const pagination = document.getElementById("broker-pagination");

    // Limpiar el contenedor de paginaci√≥n
    pagination.innerHTML = "";

    // Aplicar estilos para que los botones est√©n en una l√≠nea horizontal
    pagination.style.display = "flex";
    pagination.style.justifyContent = "center";
    pagination.style.gap = "10px";

    // Determinar el rango de p√°ginas a mostrar
    const maxBotones = 5;
    let inicio = Math.max(1, paginaActualBroker - Math.floor(maxBotones / 2));
    let fin = Math.min(totalPaginas, inicio + maxBotones - 1);

    // Ajustar inicio si el rango es menor al m√°ximo de botones
    if (fin - inicio + 1 < maxBotones) {
        inicio = Math.max(1, fin - maxBotones + 1);
    }

    // Bot√≥n para ir a la p√°gina anterior
    if (paginaActualBroker > 1) {
        const prevButton = document.createElement("button");
        prevButton.textContent = "¬´";
        prevButton.style.padding = "10px 15px";
        prevButton.style.borderRadius = "5px";
        prevButton.style.backgroundColor = "#ff7300";
        prevButton.style.color = "white";
        prevButton.style.border = "none";
        prevButton.style.cursor = "pointer";

        prevButton.addEventListener("click", () => {
            paginaActualBroker -= 1;
            mostrarPaginaBroker();
        });

        pagination.appendChild(prevButton);
    }

    // Botones de p√°ginas
    for (let i = inicio; i <= fin; i++) {
        const button = document.createElement("button");
        button.textContent = i;
        button.style.padding = "10px 15px";
        button.style.borderRadius = "5px";
        button.style.backgroundColor = i === paginaActualBroker ? "#333" : "#ff7300";
        button.style.color = "white";
        button.style.border = "none";
        button.style.cursor = "pointer";
        button.style.transition = "background-color 0.3s";

        button.addEventListener("mouseover", () => {
            if (i !== paginaActualBroker) {
                button.style.backgroundColor = "#e66400";
            }
        });

        button.addEventListener("mouseout", () => {
            if (i !== paginaActualBroker) {
                button.style.backgroundColor = "#ff7300";
            }
        });

        button.addEventListener("click", () => {
            paginaActualBroker = i;
            mostrarPaginaBroker();
        });

        pagination.appendChild(button);
    }

    // Bot√≥n para ir a la p√°gina siguiente
    if (paginaActualBroker < totalPaginas) {
        const nextButton = document.createElement("button");
        nextButton.textContent = "¬ª";
        nextButton.style.padding = "10px 15px";
        nextButton.style.borderRadius = "5px";
        nextButton.style.backgroundColor = "#ff7300";
        nextButton.style.color = "white";
        nextButton.style.border = "none";
        nextButton.style.cursor = "pointer";

        nextButton.addEventListener("click", () => {
            paginaActualBroker += 1;
            mostrarPaginaBroker();
        });

        pagination.appendChild(nextButton);
    }
}

const companiasPorPagina = 12; // Cantidad de compa√±√≠as por p√°gina
let companiasActuales = []; // Almacenar√° las compa√±√≠as cargadas para la pesta√±a activa
let paginaActual = 1; // P√°gina actual

async function cargarCompanias(tipo) {
    const container = document.getElementById(`${tipo}-container`);
    try {
        container.innerHTML = "<p>Cargando compa√±√≠as...</p>";
        const response = await fetch(`https://herramienta-inversion.onrender.com/obtener-companias?tipo=${tipo}`);
        if (!response.ok) {
            throw new Error(`Error en la solicitud: ${response.status}`);
        }

        const companias = await response.json();
        console.log("Datos recibidos del servidor:", companias); // Depuraci√≥n
        if (companias.length > 0) {
            companiasActuales = companias; // Almacenar compa√±√≠as cargadas
            paginaActual = 1; // Reiniciar a la primera p√°gina
            mostrarPagina(tipo);
        } else {
            container.innerHTML = "<p>No hay compa√±√≠as disponibles en este momento.</p>";
        }
    } catch (error) {
        console.error("Error al cargar las compa√±√≠as:", error);
        container.innerHTML = `<p class="error">Error al cargar las compa√±√≠as: ${error.message}</p>`;
    }
}


function mostrarPagina(tipo) {
    const container = document.getElementById(`${tipo}-container`);
    const inicio = (paginaActual - 1) * companiasPorPagina;
    const fin = inicio + companiasPorPagina;

    // Obtener las compa√±√≠as de la p√°gina actual
    const companiasPagina = companiasActuales.slice(inicio, fin);

    // Limpiar el contenedor
    container.innerHTML = "";

    // Depuraci√≥n: Ver datos de las compa√±√≠as
    console.log("Compa√±√≠as para la p√°gina actual:", companiasPagina);

    // Crear las tarjetas
    companiasPagina.forEach((compania) => {
        const cardHTML = `
            <div class="compania-card">
                <h3>${compania.nombre || "Nombre no disponible"}</h3>
                <p>${compania.descripcion || "Descripci√≥n no disponible."}</p>
            </div>
        `;
        container.innerHTML += cardHTML;
    });

    actualizarPaginacion(tipo);
}



function actualizarPaginacion(tipo) {
    const totalPaginas = Math.ceil(companiasActuales.length / companiasPorPagina);
    const pagination = document.getElementById("pagination");

    pagination.innerHTML = ""; // Limpiar el contenedor de paginaci√≥n

    for (let i = 1; i <= totalPaginas; i++) {
        const button = document.createElement("button");
        button.textContent = i;
        button.classList.toggle("active", i === paginaActual);
        button.onclick = () => {
            paginaActual = i;
            mostrarPagina(tipo);
        };
        pagination.appendChild(button);
    }
}

function mostrarPestana(tipo) {
    const pestanas = ["luz", "gas", "luzygas"];
    pestanas.forEach((pestana) => {
        const container = document.getElementById(`${pestana}-container`);
        const tabButton = document.getElementById(`tab-${pestana}`);
        if (pestana === tipo) {
            container.style.display = "grid";
            tabButton.classList.add("active");
            cargarCompanias(tipo);
        } else {
            container.style.display = "none";
            tabButton.classList.remove("active");
        }
    });
}

function showAsistenteHipotecas() {
    // Ocultar todas las secciones
    const sections = document.querySelectorAll("main > section");
    sections.forEach(section => section.classList.add("hidden"));

    // Mostrar la secci√≥n del asistente hipotecario
    let hipotecaSection = document.getElementById("asistente-hipotecas");
    if (!hipotecaSection) {
        hipotecaSection = document.createElement("section");
        hipotecaSection.id = "asistente-hipotecas";
        document.getElementById("main-content").appendChild(hipotecaSection);
    }

    // Actualizar contenido
    hipotecaSection.classList.remove("hidden");
}

function showBuscadorCompanias() {
    // Ocultar todas las secciones existentes
    const sections = document.querySelectorAll("main > section");
    sections.forEach(section => section.classList.add("hidden"));

    // Crear o seleccionar la secci√≥n del buscador de compa√±√≠as
    let buscadorSection = document.getElementById("buscador-companias");

    if (!buscadorSection) {
        // Crear la secci√≥n si no existe
        buscadorSection = document.createElement("section");
        buscadorSection.id = "buscador-companias";
        document.getElementById("main-content").appendChild(buscadorSection);
    }

    // Insertar contenido en la secci√≥n del buscador
    buscadorSection.innerHTML = `
        <h2 style="color: #ff7300; text-align: center;">Buscador de Compa√±√≠as</h2>
        <div id="buscador-container" style="
            background-color: #222; 
            padding: 30px; 
            border-radius: 8px; 
            max-width: 800px; 
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 500px;">
            
            <div id="chat-messages" style="
                width: 100%; 
                background-color: #333; 
                padding: 30px; 
                border-radius: 8px; 
                color: #fff; 
                font-size: 18px;
                text-align: left;
                line-height: 1.8;
                height: auto;
                max-height: none;">
                
                <div class="message assistant" style="
                    background-color: #444; 
                    padding: 20px; 
                    border-radius: 8px; 
                    margin-bottom: 10px;">
                    
                    <strong>Asistente de Comparaci√≥n de Servicios:</strong><br><br>

                    Hola, soy tu asistente para encontrar las mejores ofertas en luz y gas.<br><br>

                    Mi trabajo es ayudarte a pagar menos y obtener las mejores condiciones de tus suministros.<br><br>

                    Aqu√≠ no tienes que buscar ni comparar manualmente:
                    <ul style="text-align: left; padding-left: 20px;">
                        <li>Analizo por ti las compa√±√≠as disponibles.</li>
                        <li>Comparo tarifas, descuentos y condiciones en tiempo real.</li>
                        <li>Te recomiendo, en orden de preferencia, las mejores opciones seg√∫n tu consumo.</li>
                    </ul>
                    Cuanto mejor optimices tu contrato, mayor ser√° tu ahorro cada mes.<br><br>

                    Dime, ¬øquieres saber cu√°l es la mejor oferta para ti?
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <p id="coming-soon" style="
                    color: #ff7300; 
                    font-size: 20px; 
                    font-weight: bold; 
                    animation: blink 1.5s infinite;">
                    Pr√≥ximamente Disponible
                </p>
            </div>
        </div>
    `;

    // Mostrar la secci√≥n asegur√°ndose de que no est√© oculta
    buscadorSection.classList.remove("hidden");
}

function showSimuladorNegociaciones() {
    // Ocultar todas las secciones existentes
    const sections = document.querySelectorAll("main > section");
    sections.forEach(section => section.classList.add("hidden"));

    // Verificar si la secci√≥n ya existe
    let simuladorSection = document.getElementById("simulador-negociaciones");

    if (!simuladorSection) {
        // Crear la secci√≥n si no existe
        simuladorSection = document.createElement("section");
        simuladorSection.id = "simulador-negociaciones";
        document.getElementById("main-content").appendChild(simuladorSection);
    }

    // Insertar contenido en la secci√≥n del simulador
    simuladorSection.innerHTML = `
        <h2 style="color: #ff7300; text-align: center;">Simulador de Negociaciones</h2>
        <div id="simulador-container" style="
            background-color: #222; 
            padding: 30px; 
            border-radius: 8px; 
            max-width: 800px; 
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 500px;">
            
            <div id="chat-messages" style="
                width: 100%; 
                background-color: #333; 
                padding: 30px; 
                border-radius: 8px; 
                color: #fff; 
                font-size: 18px;
                text-align: left;
                line-height: 1.8;
                height: auto;
                max-height: none;">
                
                <div class="message assistant" style="
                    background-color: #444; 
                    padding: 20px; 
                    border-radius: 8px; 
                    margin-bottom: 10px;">
                    
                    <strong>Asistente de Negociaciones:</strong><br><br>

                    ¬°Hola! Soy tu asistente de negociaciones inmobiliarias.<br><br>

                    Mi trabajo es ayudarte a comprar, vender o alquilar con confianza, utilizando estrategias reales y datos actualizados del mercado.<br><br>

                    Aqu√≠ puedes practicar sin riesgos:
                    <ul style="text-align: left; padding-left: 20px;">
                        <li>Simula conversaciones con compradores, vendedores o inquilinos.</li>
                        <li>Mejora tus habilidades para cerrar acuerdos m√°s favorables.</li>
                        <li>Aprende a manejar objeciones y negociar con seguridad.</li>
                    </ul>
                    Cuanto m√°s practiques, mejores ser√°n tus resultados en el mundo real.<br><br>

                    ¬øQu√© tipo de negociaci√≥n quieres ensayar hoy?
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <p id="coming-soon" style="
                    color: #ff7300; 
                    font-size: 20px; 
                    font-weight: bold; 
                    animation: blink 1.5s infinite;">
                    Pr√≥ximamente Disponible
                </p>
            </div>
        </div>
    `;

    // Mostrar la secci√≥n asegur√°ndose de que no est√© oculta
    simuladorSection.classList.remove("hidden");
}

// Asegurar que el dashboard-summary se muestra por defecto
document.addEventListener("DOMContentLoaded", () => {
    const dashboard = document.getElementById("dashboard-summary");
    
    if (dashboard) {
        dashboard.classList.remove("hidden"); // Asegurar que el dashboard es visible
    }

    // Ocultar todas las dem√°s secciones excepto el dashboard
    const sections = document.querySelectorAll("main > section");
    sections.forEach(section => {
        if (section.id !== "dashboard-summary") {
            section.classList.add("hidden");
        }
    });

    // Crear un contenedor din√°mico si no existe
    if (!document.getElementById("beta-section")) {
        const betaSection = document.createElement("section");
        betaSection.id = "beta-section";
        betaSection.classList.add("hidden");
        document.getElementById("main-content").appendChild(betaSection);
    }
});

document.addEventListener("DOMContentLoaded", function() {
    if (!localStorage.getItem("userEmail")) {
        document.getElementById("emailPopup").style.display = "flex";
    }
});

function guardarEmail() {
    let email = document.getElementById("emailInput").value.trim();
    
    if (email === "" || !email.includes("@")) {
        alert("Por favor, introduce un email v√°lido.");
        return;
    }

    // Guardamos el email en localStorage para evitar que vuelva a salir el popup
    localStorage.setItem("userEmail", email);

    // Ocultamos el popup
    document.getElementById("emailPopup").style.display = "none";

    // Enviar el email al backend
    fetch("https://herramienta-inversion.onrender.com/guardar-email", {  // ‚ö†Ô∏è CAMBIO: Asegurar que usa el puerto 5001
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email: email })
    })
    .then(response => response.json())
    .then(data => {
        console.log("Respuesta del backend:", data);
        alert("Correo guardado correctamente.");
    })
    .catch(error => console.error("Error al guardar el email:", error));
}


    </script>
</body>
</html>
